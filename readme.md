Esse é meu código refatorado.